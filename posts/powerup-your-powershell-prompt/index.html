<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PowerUp your PowerShell prompt | CloudLumberjack</title><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="PowerUp your PowerShell prompt" /><meta name="author" content="Andrew Campbell" /><meta property="og:locale" content="en_US" /><meta name="description" content="Improve your PowerShell experience with integrated command history and prediction, git status, file icons, fonts, and more." /><meta property="og:description" content="Improve your PowerShell experience with integrated command history and prediction, git status, file icons, fonts, and more." /><link rel="canonical" href="https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/" /><meta property="og:url" content="https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/" /><meta property="og:site_name" content="CloudLumberjack" /><meta property="og:image" content="https://cloudlumberjack.com/assets/img/shell/shell1.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-19T00:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://cloudlumberjack.com/assets/img/shell/shell1.png" /><meta property="twitter:title" content="PowerUp your PowerShell prompt" /><meta name="twitter:site" content="@acampb_" /><meta name="twitter:creator" content="@Andrew Campbell" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"mainEntityOfPage":{"@type":"WebPage","@id":"https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/"},"description":"Improve your PowerShell experience with integrated command history and prediction, git status, file icons, fonts, and more.","@type":"BlogPosting","url":"https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/","headline":"PowerUp your PowerShell prompt","dateModified":"2020-12-19T00:00:00-05:00","datePublished":"2020-12-19T00:00:00-05:00","image":"https://cloudlumberjack.com/assets/img/shell/shell1.png","author":{"@type":"Person","name":"Andrew Campbell"},"@context":"https://schema.org"}</script><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="preload" as="style" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /><link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" async></script> <script src="/assets/js/post.min.js" async></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-P32E6G6KFG"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-P32E6G6KFG'); </script> <script src="/app.js" defer></script><meta property="og:description" content="" /><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/lumberjack.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">CloudLumberjack</a></div><div class="site-subtitle font-italic">A blog about cloud, DevOps, Azure, PowerShell, automation, and whatever else</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/acampb" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/acampb_" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="https://linkedin.com/in/acampb" target="_blank"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['andrewbcampbell','outlook.com'].join('@')" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>PowerUp your PowerShell prompt</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>PowerUp your PowerShell prompt</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 19, 2020, 12:00 AM -0500" > Dec 19, 2020 <i class="unloaded">2020-12-19T00:00:00-05:00</i> </span> by <span class="author"> Andrew Campbell </span></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jan 18, 2021, 2:00 PM -0500" > Jan 18 <i class="unloaded">2021-01-18T14:00:41-05:00</i> </span></div></div><div class="post-content"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/shell1.png" class="post-preview-img"><h2 id="overview">Overview</h2><p>One of the great things about PowerShell is that is so extensible and customizable. When sharing my screen with co-workers and customers a frequent exchange happens:</p><blockquote><p>“Oh, what shell are you using?”</p></blockquote><blockquote><p>“PowerShell.”</p></blockquote><blockquote><p>“How do you make it look like that? Mine is just blue.”</p></blockquote><p>So let’s go through the different items I’m using to build this PowerShell experience.</p><ul><li>PowerShell 7.1<li>Windows Terminal<li>NerdFonts<li>PowerShell Modules<ul><li>poshgit<li>PSReadLine beta<li>Az.Tools.Predictor<li>oh-my-posh<li>TerminalIcons</ul></ul><h2 id="install-a-better-shell">Install a better shell</h2><p>I’m a big fan of utilizing Chocolatey to install and update Windows applications. Head over to <a href="https://chocolatey.org/install" target="_blank">https://chocolatey.org/install</a> and follow the installation instructions to get Chocolatey on your system.</p><ul><li><p><strong>PowerShell 7.1</strong> is my daily driver; it’s been rock solid for me and has significant performance increases over previous versions (especially if you’re coming from Windows PowerShell 5.1). <a href="https://devblogs.microsoft.com/powershell/announcing-powershell-7-1/" target="_blank">https://devblogs.microsoft.com/powershell/announcing-powershell-7-1/</a></p><li><p><strong>Windows Terminal</strong> is the new, modern terminal application that Microsoft has recently released. It has tons of quality of life improvements such as tabs, fonts, theming, styling, GPU rendering, running multiple shells (like WSL), and more. <a href="https://docs.microsoft.com/en-us/windows/terminal/" target="_blank">https://docs.microsoft.com/en-us/windows/terminal/</a></p></ul><p>We’re going to install the applications we need with Chocolatey.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>choco <span class="nb">install </span>powershell-core, microsoft-windows-terminal
</pre></table></code></div></div><p>If we start up Windows Terminal, it should default to PowerShell 7.1 and look like a pretty basic shell.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/shell-basic.png" alt="shell-basic" /></p><p>The rest of this article will walk through installing and configuring various modules and tools to improve this experience.</p><h2 id="install-posh-git">Install posh-git</h2><p><a href="https://github.com/dahlbyk/posh-git" target="_blank">posh-git</a> is a PowerShell module that integrates Git and PowerShell by providing Git status summary information that can be displayed in the PowerShell prompt, e.g.:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/posh-git.png" alt="posh-git" /></p><p>Install the <code class="language-plaintext highlighter-rouge">posh-git</code> PowerShell Module using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'posh-git'</span><span class="w"> </span><span class="nt">-Scope</span><span class="w"> </span><span class="s1">'CurrentUser'</span><span class="w">
</span></pre></table></code></div></div><p>Import the module in your current shell with the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'posh-git'</span><span class="w">
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>Note: We’ll only see the git status integration appear when we are in a git-enabled directory (where a hidden .git directory exists).</table></div><h2 id="install-terminal-icons">Install Terminal-Icons</h2><p><a href="https://github.com/devblackops/Terminal-Icons" target="_blank">Terminal-Icons</a> is a PowerShell module that adds file and folder icons when displaying items in the terminal. This relies on the custom fonts provided by Nerd Fonts.</p><p>You must be using one of the fonts provided by Nerd Fonts for this module to work as these fonts include tons of custom glyphs/icons that are referenced by their unicode number.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/terminal-icons.png" alt="terminal-icons" /></p><p>Install the <code class="language-plaintext highlighter-rouge">terminal-icons</code> PowerShell Module using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'terminal-icons'</span><span class="w"> </span><span class="nt">-Scope</span><span class="w"> </span><span class="s1">'CurrentUser'</span><span class="w">
</span></pre></table></code></div></div><p>Import the module in your current shell with the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'terminal-icons'</span><span class="w">
</span></pre></table></code></div></div><h2 id="install-a-font-from-nerdfont">Install a font from NerdFont</h2><p><a href="https://www.nerdfonts.com" target="_blank">Nerd Fonts</a> patches developer targeted fonts with a high number of glyphs (icons). Specifically to add a high number of extra glyphs from popular ‘iconic fonts’ such as Font Awesome, Devicons, Octicons, and others.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/nerdfonts.png" alt="nerdfonts" /></p><p>Currently I’m using <code class="language-plaintext highlighter-rouge">Mononoki</code>, but choose anything you like from the downloads page: <a href="https://www.nerdfonts.com/font-downloads" target="_blank">https://www.nerdfonts.com/font-downloads</a></p><p>Download the zip file and extract it’s contents to a directory. I’ve had trouble getting the glyphs/icons to display correctly when trying to use anything other than <strong>Regular</strong> (i.e., bold, italic, light); so just stick with regular. Right click on the font you want to install and click <strong>Install for all users</strong>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/install-font.png" alt="install-font" /></p><p>We need to configure Windows Terminal to use our new font, but before we can do that we need to find the exact font name to specify. Open Windows 10 <em>Settings &gt; Personalization &gt; Fonts</em> you can search for “mononoki” and see that the actual font name is <code class="language-plaintext highlighter-rouge">mononoki NF</code>, this is what we will need for Windows Terminal.</p><p>Open Windows Terminal settings, we will have JSON code blocks for each of our Terminal profiles. You should have one for “PowerShell”, add a line for <code class="language-plaintext highlighter-rouge">fontFace</code> as below:</p><div class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"guid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{574e775e-4f2a-5b96-ac1e-a2962a402336}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"hidden"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PowerShell"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"source"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Windows.Terminal.PowershellCore"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"fontFace"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mononoki NF"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div class="table-wrapper"><table><tbody><tr><td>Note: Because this file is JSON, the line preceding our new fontFace line will need to have a comma added to the end of the line.</table></div><h2 id="install-oh-my-posh">Install oh-my-posh</h2><p><a href="https://github.com/JanDeDobbeleer/oh-my-posh" target="_blank">oh-my-posh</a> is a theme engine for PowerShell inspired from oh-my-zsh on OSX and Linux.</p><p>It is also dependant on having a NerdFont installed so glyphs/icons render correctly, and it requires <code class="language-plaintext highlighter-rouge">posh-git</code> to be installed for git status integration.</p><p>Install the <code class="language-plaintext highlighter-rouge">terminal-icons</code> PowerShell Module using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'oh-my-posh'</span><span class="w"> </span><span class="nt">-Scope</span><span class="w"> </span><span class="s1">'CurrentUser'</span><span class="w">
</span></pre></table></code></div></div><p>Import the module in your current shell with the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'oh-my-posh'</span><span class="w">
</span></pre></table></code></div></div><p>There are numerous themes included with <code class="language-plaintext highlighter-rouge">oh-my-posh</code>. You can view screenshots of most them on the projects GitHub page <a href="https://github.com/JanDeDobbeleer/oh-my-posh#themes" target="_blank">here</a>, or just try them out in your shell with <code class="language-plaintext highlighter-rouge">Get-Theme</code> and <code class="language-plaintext highlighter-rouge">Set-Theme</code>. I’m currently using the theme <code class="language-plaintext highlighter-rouge">Powerlevel9k</code>.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/powerlevel9k.png" alt="powerlevel9k" /></p><p>You can set your oh-my-posh theme to the same using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Set-Theme</span><span class="w"> </span><span class="s1">'Powerlevel9k'</span><span class="w">
</span></pre></table></code></div></div><h2 id="install-psreadline">Install PSReadLine</h2><p>PSReadLine 2.2 (currently in beta) enhances the tab-completion experience by adding predictive suggestions based on your history, and a plugin model that allows other PowerShell modules to suggest cmdlets and switches.</p><p>Read more about PSReadLine: <a href="https://devblogs.microsoft.com/powershell/announcing-psreadline-2-1-with-predictive-intellisense/" target="_blank">https://devblogs.microsoft.com/powershell/announcing-psreadline-2-1-with-predictive-intellisense/</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/psreadline.png" alt="psreadline" /></p><p>Install the <code class="language-plaintext highlighter-rouge">PSReadLine</code> PowerShell Module using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'PSReadLine'</span><span class="w"> </span><span class="nt">-AllowPrerelease</span><span class="w"> </span><span class="nt">-Scope</span><span class="w"> </span><span class="s1">'CurrentUser'</span><span class="w"> </span><span class="nt">-Force</span><span class="w">
</span></pre></table></code></div></div><p>Import the module in your current shell, and configure its options with the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'PSReadLine'</span><span class="w">

</span><span class="n">Set-PSReadLineOption</span><span class="w"> </span><span class="nt">-PredictionSource</span><span class="w"> </span><span class="s1">'HistoryAndPlugin'</span><span class="w"> </span><span class="nt">-PredictionViewStyle</span><span class="w"> </span><span class="s1">'ListView'</span><span class="w">
</span></pre></table></code></div></div><h2 id="install-aztoolspredictor">Install Az.Tools.Predictor</h2><p><code class="language-plaintext highlighter-rouge">Az.Tools.Predictor</code> is the first PowerShell Module that leverages the new PSReadLine predictive interface to bring suggestions about cmdlets and required parameters. Az Predictor takes the context of the current session into account in its suggestions. With Az Predictor’s context-aware suggestions users will be guided through the discovery of cmdlets and will not need to go to the online help as often.</p><p>Read more about <code class="language-plaintext highlighter-rouge">Az.Tools.Predictor</code>: <a href="https://techcommunity.microsoft.com/t5/azure-tools/announcing-az-predictor/ba-p/1873104" target="_blank">https://techcommunity.microsoft.com/t5/azure-tools/announcing-az-predictor/ba-p/1873104</a></p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7 " data-src="/assets/img/shell/az.tools.predictor.gif" alt="az.tools.predictor" /></p><p>Install the <code class="language-plaintext highlighter-rouge">Az.Tools.Predictor</code> PowerShell Module using the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Install-Module</span><span class="w"> </span><span class="nt">-Name</span><span class="w"> </span><span class="s1">'Az.Tools.Predictor'</span><span class="w"> </span><span class="nt">-Scope</span><span class="w"> </span><span class="s1">'CurrentUser'</span><span class="w">
</span></pre></table></code></div></div><p>Import the module in your current shell, and configure its options with the following:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'Az.Tools.Predictor'</span><span class="w">
</span></pre></table></code></div></div><h2 id="configure-your-powershell-profile">Configure your PowerShell Profile</h2><p>So far we’ve been manually importing and configuring the various modules manually, the better way to handle this is to configure your PowerShell Profile to configure everything for you when you start a new PowerShell session. A PowerShell profile is a <code class="language-plaintext highlighter-rouge">.ps1</code> script that runs when PowerShell starts. PowerShell supports several profiles for users and host programs. However, it does not create the profiles for you.</p><p>If I run <code class="language-plaintext highlighter-rouge">$profile</code> from a PowerShell prompt, it will return the path to the profile for that specific host. On my system the path to my profile is <code class="language-plaintext highlighter-rouge">C:\Users\acampb\Documents\PowerShell\Microsoft.PowerShell_profile.ps1</code>.</p><p>PowerShell supports multiple “hosts” with different PowerShell profiles. We’re not going to do a deep dive one PowerShell hosts here, if you want to read more check out the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7" target="_blank">Microsoft documentation</a>. The one item I have noticed is that your work on PowerShell files using VS Code, and you use the PowerShell extension, when the PowerShell Integrated Console launches it uses a different <code class="language-plaintext highlighter-rouge">$profile</code> file path. In order for my PowerShell configuration to be loaded in all hosts we can create a file named <code class="language-plaintext highlighter-rouge">profile.ps1</code> which is always executed.</p><p>Create a new file named <code class="language-plaintext highlighter-rouge">profile.ps1</code> in <code class="language-plaintext highlighter-rouge">$home\Documents\PowerShell</code> and add the following content. Note these are all the cmdlets we used to import and configure our modules.</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'posh-git'</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'Terminal-Icons'</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'oh-my-posh'</span><span class="w">
</span><span class="n">Set-Theme</span><span class="w"> </span><span class="s1">'Powerlevel9k'</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'Az.Tools.Predictor'</span><span class="w">
</span><span class="n">Import-Module</span><span class="w"> </span><span class="s1">'PSReadLine'</span><span class="w">
</span><span class="n">Set-PSReadLineOption</span><span class="w"> </span><span class="nt">-PredictionSource</span><span class="w"> </span><span class="s1">'HistoryAndPlugin'</span><span class="w"> </span><span class="nt">-PredictionViewStyle</span><span class="w"> </span><span class="s1">'ListView'</span><span class="w">
</span></pre></table></code></div></div><p>Save <code class="language-plaintext highlighter-rouge">profile.ps1</code>, close and re-open PowerShell and enjoy your upgraded PowerShell experience!</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/powershell/" class="post-tag no-text-decoration" >PowerShell</a> <a href="/tags/windows-terminal/" class="post-tag no-text-decoration" >Windows Terminal</a> <a href="/tags/azure/" class="post-tag no-text-decoration" >Azure</a> <a href="/tags/git/" class="post-tag no-text-decoration" >Git</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=PowerUp your PowerShell prompt - CloudLumberjack&url=https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://cloudlumberjack.com/posts/powerup-your-powershell-prompt/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/azureautotagger/">Serverless tagging with Event Grid and Azure Functions</a><li><a href="/posts/start-with-why/">Start with why</a><li><a href="/posts/setup-github-verified-commits-for-vscode/">Setup GitHub verified commits for VSCode</a><li><a href="/posts/powerup-your-powershell-prompt/">PowerUp your PowerShell prompt</a><li><a href="/posts/ado-pr-psscriptanalyzer/">Azure DevOps PowerShell code analysis with Pull Request comments</a></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/github/">GitHub</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/cicd-pipeline/">CICD Pipeline</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/windows-terminal/">Windows Terminal</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/serverless/">Serverless</a> <a class="post-tag" href="/tags/pullrequest/">PullRequest</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><h3 data-toc-skip class="pl-3 pt-2 mb-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/azureautotagger/"><div class="card-body"> <span class="timeago small" > Jan 6 <i class="unloaded">2021-01-06T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Serverless tagging with Event Grid and Azure Functions</h3><div class="text-muted small"><p> Overview Azure AutoTagger is a lightweight, low-cost serverless solution that can easily be deployed to an Azure subscription. Once deployed Azure AutoTagger monitors for ResourceWriteSucess event...</p></div></div></a></div><div class="card"> <a href="/posts/ado-pr-psscriptanalyzer/"><div class="card-body"> <span class="timeago small" > Nov 1, 2020 <i class="unloaded">2020-11-01T00:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Azure DevOps PowerShell code analysis with Pull Request comments</h3><div class="text-muted small"><p> Overview If you are using PowerShell you should be storing your code in a code repository. GitHub and Azure DevOps are great choices, but really any git repo will do. This isn’t an article about w...</p></div></div></a></div><div class="card"> <a href="/posts/github-actions-approvals/"><div class="card-body"> <span class="timeago small" > Jan 6 <i class="unloaded">2021-01-06T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>GitHub Actions now with Manual Approvals</h3><div class="text-muted small"><p> Overview I’ve loved GitHub Actions since they were released, but the one piece I always felt was missing was some kind of gating or more control around deployments. Now we can add manual approval ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/ado-pr-psscriptanalyzer/" class="btn btn-outline-primary"><p>Azure DevOps PowerShell code analysis with Pull Request comments</p></a> <a href="/posts/github-actions-approvals/" class="btn btn-outline-primary"><p>GitHub Actions now with Manual Approvals</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/acampb_">Andrew Campbell</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/powershell/">PowerShell</a> <a class="post-tag" href="/tags/github/">GitHub</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/cicd-pipeline/">CICD Pipeline</a> <a class="post-tag" href="/tags/azure/">Azure</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/windows-terminal/">Windows Terminal</a> <a class="post-tag" href="/tags/vscode/">VSCode</a> <a class="post-tag" href="/tags/serverless/">Serverless</a> <a class="post-tag" href="/tags/pullrequest/">PullRequest</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://cloudlumberjack.com{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
